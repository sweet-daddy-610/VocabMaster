<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="VocabMaster - 英语词汇积累工具，中英双语词典、自动记录、艾宾浩斯记忆曲线复习">
  <title>VocabMaster · 英语词汇大师</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="src/styles/index.css">
  <link rel="stylesheet" href="src/styles/dictionary.css">
  <link rel="stylesheet" href="src/styles/review.css">
  <link rel="stylesheet" href="src/styles/history.css">
  <link rel="stylesheet" href="src/styles/settings.css">
</head>

<body>
  <!-- Header (macOS drag region) -->
  <header class="app-header"></header>


  <!-- Main Content -->
  <main class="app-main">
    <!-- Dictionary Page -->
    <section class="page active" id="pageDictionary">
      <!-- Stats Bar -->
      <div class="content-stats" id="headerStats">
        <div class="stat-badge" id="totalWordsBadge">
          <span class="stat-number" id="totalWordsCount">0</span>
          <span class="stat-label">已收录</span>
        </div>
        <div class="stat-badge review-badge" id="dueWordsBadge">
          <span class="stat-number" id="dueWordsCount">0</span>
          <span class="stat-label">待复习</span>
        </div>
      </div>
      <div class="search-container">
        <div class="search-box">
          <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input type="text" id="searchInput" placeholder="输入单词、短语或中文..." autocomplete="off" spellcheck="false">
          <button class="search-btn" id="searchBtn">查询</button>
        </div>
        <div class="search-suggestions" id="searchSuggestions"></div>
      </div>

      <div class="result-container" id="resultContainer">
        <!-- Welcome state -->
        <div class="welcome-state" id="welcomeState">
          <div class="welcome-illustration">
            <span class="welcome-emoji">🌟</span>
          </div>
          <h2>开启你的英语词汇之旅</h2>
          <p>输入英文单词、短语或中文，获取中英双语释义</p>
          <div class="quick-words">
            <span class="quick-word" data-word="serendipity">serendipity</span>
            <span class="quick-word" data-word="how are you">how are you</span>
            <span class="quick-word" data-word="resilient">resilient</span>
            <span class="quick-word" data-word="你好">你好</span>
          </div>
        </div>

        <!-- Loading state -->
        <div class="loading-state hidden" id="loadingState">
          <div class="loading-spinner"></div>
          <p>正在查询...</p>
        </div>

        <!-- Error state -->
        <div class="error-state hidden" id="errorState">
          <span class="error-emoji">😕</span>
          <h3>未找到该单词</h3>
          <p id="errorMessage">请检查拼写后重试</p>
        </div>

        <!-- Result state -->
        <div class="result-state hidden" id="resultState">
          <div class="word-header">
            <div class="word-title-row">
              <h2 class="word-title" id="wordTitle"></h2>
              <button class="sound-btn" id="soundBtn" title="播放发音">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                  <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                  <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
                </svg>
              </button>
              <span class="saved-indicator hidden" id="savedIndicator">✓ 已收录</span>
            </div>
            <span class="word-phonetic" id="wordPhonetic"></span>
          </div>

          <!-- Chinese Translation -->
          <div class="translation-card" id="translationCard">
            <div class="translation-card-header">
              <div class="card-label">中文释义</div>
              <button class="retranslate-btn hidden" id="retranslateBtn" title="使用当前配置的 AI 模型重新翻译">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 4v6h6"></path>
                  <path d="M3.51 15a9 9 0 1 0 .49-3.5"></path>
                </svg>
                <span>AI 重译</span>
              </button>
            </div>
            <div class="translation-content" id="translationContent"></div>
          </div>

          <!-- English Definitions -->
          <div class="definitions-section" id="definitionsSection"></div>
        </div>
      </div>
    </section>

    <!-- History Page -->
    <section class="page" id="pageHistory">
      <div class="history-header">
        <h2>📚 我的词汇本</h2>
        <div class="history-controls">
          <div class="history-search-box">
            <svg class="search-icon-small" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input type="text" id="historySearch" placeholder="搜索词汇...">
          </div>
          <select id="historySort" class="history-sort">
            <option value="newest">最新添加</option>
            <option value="oldest">最早添加</option>
            <option value="alpha">字母顺序</option>
            <option value="level">熟练度</option>
          </select>
        </div>
      </div>
      <div class="backup-actions">
        <button class="backup-btn export-btn" id="exportBtn" title="导出词汇数据">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          <span>导出备份</span>
        </button>
        <button class="backup-btn import-btn" id="importBtn" title="从备份文件恢复">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          <span>导入备份</span>
        </button>
        <input type="file" id="importFileInput" accept=".json" class="hidden">
      </div>
      <div class="history-stats" id="historyStats"></div>
      <div class="history-list" id="historyList">
        <div class="empty-history" id="emptyHistory">
          <span class="empty-emoji">📝</span>
          <h3>还没有收录任何单词</h3>
          <p>去查词页面搜索单词吧！</p>
        </div>
      </div>
    </section>

    <!-- Review Page -->
    <section class="page" id="pageReview">
      <div class="review-header">
        <h2>🧠 间隔复习</h2>
        <p class="review-subtitle">基于艾宾浩斯记忆曲线，科学巩固记忆</p>
      </div>

      <!-- No review state -->
      <div class="no-review-state" id="noReviewState">
        <div class="no-review-illustration">
          <span class="celebrate-emoji">🎉</span>
        </div>
        <h3>暂无待复习单词</h3>
        <p>你已经完成了所有复习任务！</p>
        <div class="next-review-info" id="nextReviewInfo"></div>
      </div>

      <!-- Review card state -->
      <div class="review-card-container hidden" id="reviewCardContainer">
        <div class="review-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="reviewProgressFill"></div>
          </div>
          <span class="progress-text" id="reviewProgressText">0 / 0</span>
        </div>

        <div class="flashcard" id="flashcard">
          <div class="flashcard-inner" id="flashcardInner">
            <div class="flashcard-front">
              <div class="flashcard-word" id="flashcardWord"></div>
              <div class="flashcard-phonetic" id="flashcardPhonetic"></div>
              <button class="flashcard-sound-btn" id="flashcardSoundBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                  <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                </svg>
              </button>
              <p class="flashcard-hint">点击卡片查看释义</p>
            </div>
            <div class="flashcard-back">
              <div class="flashcard-back-word" id="flashcardBackWord"></div>
              <div class="flashcard-translation" id="flashcardTranslation"></div>
              <div class="flashcard-definition" id="flashcardDefinition"></div>
              <p class="flashcard-hint">点击卡片返回正面</p>
            </div>
          </div>
        </div>

        <div class="review-actions">
          <button class="review-btn forgot-btn" id="forgotBtn">
            <span class="btn-icon">✗</span>
            <span>忘记了</span>
          </button>
          <button class="review-btn remembered-btn" id="rememberedBtn">
            <span class="btn-icon">✓</span>
            <span>记住了</span>
          </button>
        </div>

        <div class="review-level-info" id="reviewLevelInfo"></div>
      </div>

      <!-- Review complete -->
      <div class="review-complete hidden" id="reviewComplete">
        <span class="complete-emoji">🏆</span>
        <h3>本轮复习完成！</h3>
        <div class="review-summary" id="reviewSummary"></div>
        <button class="restart-btn" id="restartReviewBtn">再复习一次</button>
      </div>
    </section>
  </main>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <button class="nav-btn active" data-page="pageDictionary">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <span>查词</span>
    </button>
    <button class="nav-btn" data-page="pageHistory">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
      </svg>
      <span>词汇本</span>
      <span class="nav-badge hidden" id="historyBadge"></span>
    </button>
    <button class="nav-btn" data-page="pageReview">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      </svg>
      <span>复习</span>
      <span class="nav-badge hidden" id="reviewBadge"></span>
    </button>
    <button class="nav-btn" id="settingsNavBtn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path
          d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42">
        </path>
      </svg>
      <span>设置</span>
    </button>
  </nav>

  <!-- Settings Modal -->
  <div class="settings-overlay hidden" id="settingsOverlay">
    <div class="settings-modal">
      <div class="settings-header">
        <h2>⚙️ 设置</h2>
        <button class="settings-close-btn" id="settingsCloseBtn">&times;</button>
      </div>
      <div class="settings-body">
        <div class="settings-section">
          <h3>🤖 AI 翻译</h3>
          <p class="settings-desc">配置大模型 API Key 后，当词典无法查到结果时，将自动调用 AI 进行智能翻译。</p>
          <div class="settings-field">
            <label for="llmProvider">大模型服务</label>
            <select id="llmProvider" class="settings-select">
              <option value="deepseek">DeepSeek</option>
              <option value="gemini">Google Gemini</option>
            </select>
          </div>
          <div class="settings-field">
            <label for="deepseekApiKey">API Key</label>
            <div class="api-key-input-row">
              <input type="password" id="deepseekApiKey" placeholder="sk-..." autocomplete="off" spellcheck="false">
              <button class="toggle-visibility-btn" id="toggleApiKeyVisibility" title="显示/隐藏">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
              </button>
            </div>
            <p class="settings-hint" id="apiKeyHint">前往 <a href="https://platform.deepseek.com/api_keys"
                id="apiKeyLink">platform.deepseek.com</a> 获取 API Key</p>
          </div>
          <div class="settings-actions">
            <button class="settings-btn test-btn" id="testApiKeyBtn">测试连接</button>
            <button class="settings-btn save-btn" id="saveApiKeyBtn">保存</button>
          </div>
          <div class="api-key-status hidden" id="apiKeyStatus"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Toast -->
  <div class="toast-container" id="toastContainer"></div>

  <script type="module" src="src/main.js"></script>
</body>

</html>